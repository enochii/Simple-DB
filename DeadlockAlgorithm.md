#### 死锁检测

> 基于检测事务之间是否出现循环资源依赖
>
> 到后来其实Transaction system Test没太懂，一个死锁是没有出现依赖的，但还是一直死循环。可能是算法实现有问题吧--哭唧唧
>
> 时间如果能重来可能会使用超时算法--

##### Concepts

一个事务拥有一个页面，那么它持有该页面的一个`Lock`

一个事务可能需要一个正在被使用的页面，那么它等待该页面，即一个事务在该页面的等待队列中

##### 获取页面的流程

当一个事务尝试获取一个页面时，需要把自己加入该页面的等待队列中

当一个事务成功获取一个页面时，把自己从等待队列中移除

当一个事务发现自己等待的页面已经被占有时，需要检测是否发生了死锁

##### 死锁检测

称事务为T，T等待的页面为P。

首先检测P的拥有者，拥有者可能为多个或一个。每个拥有者可能也在等待其他页面，对每个拥有者和每个页面继续执行当前算法，发现出现依赖即发生了死锁。

